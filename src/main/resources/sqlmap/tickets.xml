<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Tickets">
    <resultMap id="result" class="demo.Model.Tickets">
        <result property="id" column="id"/>
        <result property="employee" column="employee"/>
        <result property="ticketNum" column="ticketNum"/>
        <result property="raffleId" column="raffleId"/>
    </resultMap>

    <sql id="selectAll">
        SELECT
        id,
        employee,
        ticketNum,
        raffleId
        FROM tickets
    </sql>

    <select id="getAll" resultMap="Tickets.result">
        <include refid="selectAll"/>
        LIMIT #offset#, #limit#
    </select>

    <select id="getById" parameterClass="int" resultMap="Tickets.result">
        <include refid="selectAll"/>
        WHERE id = #value#
        LIMIT 1
    </select>

    <insert id="add" parameterClass="demo.Model.Tickets">
        INSERT
        INTO tickets SET
        employee = #employee#,
        ticketNum = #ticketNum#,
        raffleId = #raffleId#
        <selectKey keyProperty="id" resultClass="int">
            SELECT
            LAST_INSERT_ID() AS value
        </selectKey>
    </insert>

    <insert id="update" parameterClass="demo.Model.Tickets">
        UPDATE tickets SET
        ticketNum = #ticketNum#,
        WHERE 
        raffleId = #raffleId#,
        employee = #employee#
    </insert>

    <select id="getTickets" parameterClass="demo.Model.Tickets" resultMap="Tickets.result">
        SELECT
        ticketNum
        FROM tickets
        WHERE 
        employee = #employee#,
        raffleId = #raffleId#
        LIMIT 1
    </select>

</sqlMap>